include ./_ratingForm
include ./_resultCard
include ./_storyRating

mixin storyCard(story, page, count)
	.story
		.story__content
			if page > 1
				a(href=`/stories/page/${parseInt(page) - 1}`)
					img(src=`/images/icons/left-arrow.svg` class='story__arrows--left')
			else
				img(src=`/images/icons/left-arrow.svg` class='story__arrows--left--hidden')
			h2= story.description
			if user
				a(class="story__content--edit" href=`/stories/${story._id}/edit`)
					!=h.icon('pencil')
			if page < count
				a(href=`/stories/page/${parseInt(page) + 1}`)
					img(src=`/images/icons/right-arrow.svg` class='story__arrows--right')
			else
				img(src=`/images/icons/right-arrow.svg` class='story__arrows--right--hidden')
		+ratingForm(story)
		if story.ratings 
			.results
				.results__row
					h3.results__heading Not Ok
					- const percentNot = 100 - story.percentOk
					- const nonbinNot = 100 - story.nonbinaryOk
					- const femaleNot = 100 - story.femaleOk
					- const maleNot = 100 - story.maleOk
					+storyRating(percentNot, nonbinNot, femaleNot, maleNot)
				.results__row
					h3.results__heading Ok
					- const nonbinOk = 100 - story.nonbinaryOk
					- const femaleOk = 100 - story.femaleOk
					- const maleOk = 100 - story.maleOk
					+storyRating(story.percentOk, story.nonbinaryOk, story.femaleOk, story.maleOk)